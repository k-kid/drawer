<xml xmlns="https://developers.google.com/blockly/xml"><block type="pxt-on-start" id="=)[0;.gX6XU~QbT90V0x" x="20" y="20"><statement name="HANDLER"><block type="typescript_statement" id="H$-XDIQ/PdELRS~aMtUh" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="class Board {" line1="    public isKarelActive: boolean;" line2="    public karelX: number;" line3="    public karelY: number;" line4="" line5="    public ledState: Image;" line6="    private karelDirection: Direction;" line7="" line8="    constructor() {" line9="        this.isKarelActive = true;" line10="        this.karelX = 2;" line11="        this.karelY = 2;" line12="        this.karelDirection = Direction.UP;" line13="        this.ledState = images.createImage(`" line14="            . . . . ." line15="            . . . . ." line16="            . . . . ." line17="            . . . . ." line18="            . . . . ." line19="            `);" line20="    }" line21="" line22="    pressedA() {" line23="        if (!this.isKarelActive) {" line24="            return;" line25="        }" line26="        this.karelDirection = (this.karelDirection + 1) % 4;" line27="    }" line28="" line29="    pressedB() {" line30="        if (!this.isKarelActive) {" line31="            return;" line32="        }" line33="        this.ledState.setPixel(this.karelX, this.karelY, true);" line34="        this.moveKarel()" line35="    }" line36="" line37="    shake() {" line38="        if (!this.isKarelActive) {" line39="            return;" line40="        }" line41="        this.moveKarel()" line42="    }" line43="" line44="    private moveKarel() {" line45="        if (!this.isKarelActive) {" line46="            return;" line47="        }" line48="        switch (this.karelDirection) {" line49="            case Direction.UP:" line50="                if (this.karelY &gt; 0) {" line51="                    this.karelY -= 1;" line52="                }" line53="                break;" line54="            case Direction.LEFT:" line55="                if (this.karelX &gt; 0) {" line56="                    this.karelX -= 1;" line57="                }" line58="                break;" line59="            case Direction.DOWN:" line60="                if (this.karelY &lt; 4) {" line61="                    this.karelY += 1;" line62="                }" line63="                break;" line64="            case Direction.RIGHT:" line65="                if (this.karelX &lt; 4) {" line66="                    this.karelX += 1;" line67="                }" line68="                break;" line69="        }" line70="    }" line71="" line72="    pressedAB() {" line73="        this.isKarelActive = !this.isKarelActive;" line74="    }" line75="" line76="    update() {" line77="        this.ledState.showImage(0);" line78="    }" line79="}" numlines="80"></mutation><next><block type="typescript_statement" id="`]yPq3w(5z`L%]!/XSA@" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="const board = new Board();" numlines="1" declaredvars="board"></mutation><next><block type="typescript_statement" id="*[unSD+d7I*ncAn$./pm" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="enum Direction {" line1="    UP = 0," line2="    LEFT," line3="    DOWN," line4="    RIGHT" line5="}" numlines="6"></mutation></block></next></block></next></block></statement></block><block type="device_button_event" id="cf?`.Rv!mX]~RR(F{tSm" x="703" y="20"><field name="NAME">Button.B</field><statement name="HANDLER"><block type="typescript_statement" id="*fwoR4ef|a`e}cYTF!Vb" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="board.pressedB();" numlines="1"></mutation><next><block type="typescript_statement" id="2h,PL}[bE;=,)Ld_xB-/" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="board.update();" numlines="1"></mutation></block></next></block></statement></block><block type="device_gesture_event" id="i)Bj!qt3E5?^qGh#=5l~" x="982" y="20"><field name="NAME">Gesture.Shake</field><statement name="HANDLER"><block type="typescript_statement" id="4x9$TG8V)=Y+KQy[?jx(" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="board.shake();" numlines="1"></mutation><next><block type="typescript_statement" id="?`-:jZ{Ru~p*dO?vTM7/" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="board.update();" numlines="1"></mutation></block></next></block></statement></block><block type="device_button_event" id="$n]9`fLt,]RGPoR,3#4M" x="1243" y="20"><field name="NAME">Button.A</field><statement name="HANDLER"><block type="typescript_statement" id="B[42=}7VI@eP|OQW^YG0" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="board.pressedA();" numlines="1"></mutation><next><block type="typescript_statement" id="Xtb/m?hiu1#ReNZm*2Xy" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="board.update();" numlines="1"></mutation></block></next></block></statement></block><block type="device_button_event" id="?x^0Gr7X-Z^,677NMu13" x="1521" y="20"><field name="NAME">Button.AB</field><statement name="HANDLER"><block type="typescript_statement" id="i]+{yP-YyN}G.%w#=4,#" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="board.pressedAB();" numlines="1"></mutation><next><block type="typescript_statement" id="FVKmIT2,%C^wnEk(C7NN" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="board.update();" numlines="1"></mutation></block></next></block></statement></block><block type="device_forever" id="Z9?Gz52R-T$_HZdq1~QS" x="1809" y="20"><statement name="HANDLER"><block type="controls_if" id="?u=z=OjnW)Wo-cju2jx:"><value name="IF0"><shadow type="logic_boolean"><field name="BOOL">TRUE</field></shadow><block type="typescript_expression" id="tNy^GzPa%mVhi`3Id.mG" editable="false"><field name="EXPRESSION">board.isKarelActive</field></block></value><statement name="DO0"><block type="device_led_toggle" id="txf;o`A0/LXu!%hUrc!="><value name="x"><shadow type="math_number_minmax"><mutation min="0" max="4"/><field name="SLIDER">0</field></shadow><block type="typescript_expression" id="Yi;5[+2#1e:@pql,|554" editable="false"><field name="EXPRESSION">board.karelX</field></block></value><value name="y"><shadow type="math_number_minmax"><mutation min="0" max="4"/><field name="SLIDER">0</field></shadow><block type="typescript_expression" id="wI[6xc63),_wMb%dHQ{;" editable="false"><field name="EXPRESSION">board.karelY</field></block></value><next><block type="device_pause" id="qwSqV^9l#bxFa!xq.4pp"><value name="pause"><shadow type="timePicker" id="w`EuBAn=sHW.Z40A*_7o"><field name="ms">500</field></shadow></value></block></next></block></statement></block></statement></block></xml>